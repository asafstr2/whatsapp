{"ast":null,"code":"var _jsxFileName = \"C:\\\\web-dev\\\\whatsAppClone\\\\whatsappMern\\\\front\\\\src\\\\SideBarChat.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Avatar } from \"@material-ui/core\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"./axios\";\nimport Pusher from \"pusher-js\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textDecoration: \"none\",\n    color: \"black\"\n  },\n  SideBarChat: {\n    display: \"flex\",\n    padding: \"20px\",\n    cursor: \"pointer\",\n    borderBottom: \"1px solid #f6f6f6\"\n  }\n}));\n\nfunction SideBarChat({\n  addNewChat,\n  name,\n  id\n}) {\n  var _messages;\n\n  const [seed, setSeed] = useState(0);\n  const [messages, setMessages] = useState([]);\n  useEffect(() => {\n    setSeed(Math.floor(Math.random() * 5000));\n  }, []);\n  useEffect(() => {\n    axios.get(`/rooms/${id}`).then(res => {\n      var _res$data;\n\n      setMessages((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.messages);\n    });\n  }, [id]);\n  useEffect(() => {\n    var pusher = new Pusher(\"899744c36189f508077b\", {\n      cluster: \"ap2\"\n    });\n    const channel = pusher.subscribe(\"chats\");\n    channel.bind(\"inserted\", data => {\n      setMessages([...messages, data]);\n    });\n    return () => {\n      channel.unsubscribe();\n      channel.unbind_all();\n    };\n  }, [messages]);\n  const classes = useStyles();\n\n  let createNewChat = () => {\n    const roomName = prompt(\"pleae enter chat room\");\n\n    if (roomName) {\n      //DB goes here\n      axios.post(`/newroom`, {\n        name: roomName\n      });\n    }\n  };\n\n  return !addNewChat ? /*#__PURE__*/React.createElement(Link, {\n    to: `/rooms/${id}`,\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.SideBarChat,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    src: `https://avatars.dicebear.com/api/human/${seed}.svg`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.SideBarChatInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }, name), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }, (_messages = messages[messages.length - 1]) === null || _messages === void 0 ? void 0 : _messages.message)))) : /*#__PURE__*/React.createElement(\"div\", {\n    onClick: createNewChat,\n    className: classes.SideBarChat,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, \"Add new chat Room\"));\n}\n\nexport default SideBarChat;","map":{"version":3,"sources":["C:/web-dev/whatsAppClone/whatsappMern/front/src/SideBarChat.js"],"names":["React","useState","useEffect","makeStyles","Avatar","Link","axios","Pusher","useStyles","theme","root","textDecoration","color","SideBarChat","display","padding","cursor","borderBottom","addNewChat","name","id","seed","setSeed","messages","setMessages","Math","floor","random","get","then","res","data","pusher","cluster","channel","subscribe","bind","unsubscribe","unbind_all","classes","createNewChat","roomName","prompt","post","SideBarChatInfo","length","message"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Avatar } from \"@material-ui/core\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"./axios\";\r\nimport Pusher from \"pusher-js\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    textDecoration: \"none\",\r\n    color: \"black\",\r\n  },\r\n\r\n  SideBarChat: {\r\n    display: \"flex\",\r\n    padding: \"20px\",\r\n    cursor: \"pointer\",\r\n    borderBottom: \"1px solid #f6f6f6\",\r\n  },\r\n}));\r\n\r\nfunction SideBarChat({ addNewChat, name, id }) {\r\n  const [seed, setSeed] = useState(0);\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    setSeed(Math.floor(Math.random() * 5000));\r\n  }, []);\r\n\r\n\r\n  useEffect(() => {\r\n    axios.get(`/rooms/${id}`).then((res) =>{ setMessages(res.data?.messages) } );\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    var pusher = new Pusher(\"899744c36189f508077b\", {\r\n      cluster: \"ap2\",\r\n    });\r\n    const channel = pusher.subscribe(\"chats\");\r\n    channel.bind(\"inserted\", (data) => {\r\n      setMessages([...messages, data]);\r\n    });\r\n\r\n    return () => {\r\n      channel.unsubscribe();\r\n      channel.unbind_all();\r\n    };\r\n  }, [messages]);\r\n\r\n  const classes = useStyles();\r\n  let createNewChat = () => {\r\n    const roomName = prompt(\"pleae enter chat room\");\r\n    if (roomName) {\r\n      //DB goes here\r\n      axios.post(`/newroom`, { name: roomName });\r\n    }\r\n  };\r\n  return !addNewChat ? (\r\n    <Link to={`/rooms/${id}`} className={classes.root}>\r\n      <div className={classes.SideBarChat}>\r\n        <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\r\n        <div className={classes.SideBarChatInfo}>\r\n          <h2>{name}</h2>\r\n          <p>{messages[messages.length-1]?.message}</p>\r\n        </div>\r\n      </div>\r\n    </Link>\r\n  ) : (\r\n    <div onClick={createNewChat} className={classes.SideBarChat}>\r\n      <h2>Add new chat Room</h2>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SideBarChat;\r\n"]},"metadata":{},"sourceType":"module"}