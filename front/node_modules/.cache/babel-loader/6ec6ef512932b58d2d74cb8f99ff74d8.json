{"ast":null,"code":"var _jsxFileName = \"C:\\\\web-dev\\\\whatsAppClone\\\\whatsappMern\\\\front\\\\src\\\\Chat.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Avatar, IconButton } from \"@material-ui/core\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport SearchOutlined from \"@material-ui/icons/SearchOutlined\";\nimport AttachFile from \"@material-ui/icons/AttachFile\";\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport { useParams } from \"react-router-dom\";\nimport axios from \"./axios\";\nimport Pusher from \"pusher-js\";\nconst useStyles = makeStyles(theme => ({\n  chat: {\n    flex: \"0.65\",\n    display: \"flex\",\n    flexDirection: \"column\"\n  },\n  chatHeader: {\n    padding: \"20px\",\n    display: \"flex\",\n    alignItems: \"center\",\n    borderBottom: \"1px solid lightgray\"\n  },\n  chatHeaderInfo: {\n    flex: \"1\"\n  },\n  chatHeaderRight: {\n    marginLeft: \"auto\"\n  },\n  chatBody: {\n    flex: \"1\",\n    backgroundImage: \"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')\",\n    backgroundRepeat: \"repeat\",\n    backgroundPosition: \"center\",\n    padding: \"30px\",\n    overflow: \"auto\"\n  },\n  chatMessage: {\n    position: \"relative\",\n    fontSize: \"16px\",\n    padding: \"10px\",\n    borderRadius: \"10px\",\n    width: \"fit-content\",\n    display: \"flex\",\n    backgroundColor: \"#ffffff\",\n    marginBottom: \"4%\",\n    [theme.breakpoints.down(\"sm\")]: {\n      marginBottom: \"8%\"\n    }\n  },\n  reciver: {\n    marginLeft: \"auto\",\n    backgroundColor: \"#dcf8c6\"\n  },\n  chatName: {\n    position: \"absolute\",\n    top: \"-15px\",\n    fontSize: \"10px\"\n  },\n  chatTimeStamp: {\n    fontSize: \"xx-small\",\n    marginLeft: \"6px\",\n    alignSelf: \"flex-end\"\n  },\n  chatFooter: {\n    display: \"flex\",\n    alignItems: \"center\",\n    height: \"62px\",\n    borderTop: \"1px solid lightgray\"\n  },\n  chatFooterForm: {\n    display: \"flex\",\n    alignItems: \"center\",\n    flex: \"1\"\n  },\n  chatFooterFormInput: {\n    flex: \"1\",\n    minHeight: \"40px\",\n    borderRadius: \"20px\",\n    border: \"none\",\n    outline: \"none\",\n    paddingLeft: \"2%\",\n    fontSize: \"18px\"\n  }\n}));\n\nfunction Chat() {\n  var _messages;\n\n  const currentUserId = \"asaf\";\n  const classes = useStyles(currentUserId === \"asaf\");\n  const [seed, setSeed] = useState(0);\n  const [input, setInput] = useState(\"\");\n  const [roomName, setRoomName] = useState(\"\");\n  const {\n    roomId\n  } = useParams();\n  useEffect(() => {\n    setSeed(Math.floor(Math.random() * 5000));\n  }, []);\n  useEffect(() => {\n    axios.get(`/rooms/${roomId}`).then(res => {\n      var _res$data, _res$data2;\n\n      setMessages((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.messages);\n      setRoomName((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.name);\n    });\n  }, [roomId]);\n  const [messages, setMessages] = useState([]);\n  useEffect(() => {\n    var pusher = new Pusher(\"899744c36189f508077b\", {\n      cluster: \"ap2\"\n    });\n    const channel = pusher.subscribe(\"chats\");\n    channel.bind(\"inserted\", data => {\n      setMessages([...messages, data]);\n    });\n    return () => {\n      channel.unsubscribe();\n      channel.unbind_all();\n    };\n  }, [messages]);\n\n  let hundleSubmit = e => {\n    e.preventDefault();\n\n    if (!roomName) {\n      setMessages([{\n        message: \"please select a room\"\n      }]);\n      console.log(\"no room\");\n      return;\n    }\n\n    axios.post(`/createmessage/${roomId}`, {\n      message: input,\n      name: currentUserId,\n      timestamp: new Date()\n    });\n    setInput(\"\");\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chat,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chatHeader,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    src: `https://avatars.dicebear.com/api/human/${seed}.svg`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chatHeaderInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }, roomName), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, \"last seen:\", (_messages = messages[messages.length - 1]) === null || _messages === void 0 ? void 0 : _messages.timestamp)), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chatHeaderRight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SearchOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(AttachFile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MoreVertIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chatBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, messages === null || messages === void 0 ? void 0 : messages.map((message, i) => /*#__PURE__*/React.createElement(\"p\", {\n    key: message._id,\n    className: `${classes.chatMessage} ${message.name === currentUserId && classes.reciver}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `${classes.chatName}  `,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, \" \", message.name), message.message, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.chatTimeStamp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }\n  }, message === null || message === void 0 ? void 0 : message.timestamp)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.chatFooter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InsertEmoticonIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: hundleSubmit,\n    className: classes.chatFooterForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: classes.chatFooterFormInput,\n    placeholder: \"Type a message\",\n    value: input,\n    onChange: e => setInput(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(IconButton, {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SendIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MicIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  })))));\n}\n\nexport default Chat;","map":{"version":3,"sources":["C:/web-dev/whatsAppClone/whatsappMern/front/src/Chat.js"],"names":["React","useEffect","useState","makeStyles","Avatar","IconButton","MoreVertIcon","SearchOutlined","AttachFile","InsertEmoticonIcon","SendIcon","MicIcon","useParams","axios","Pusher","useStyles","theme","chat","flex","display","flexDirection","chatHeader","padding","alignItems","borderBottom","chatHeaderInfo","chatHeaderRight","marginLeft","chatBody","backgroundImage","backgroundRepeat","backgroundPosition","overflow","chatMessage","position","fontSize","borderRadius","width","backgroundColor","marginBottom","breakpoints","down","reciver","chatName","top","chatTimeStamp","alignSelf","chatFooter","height","borderTop","chatFooterForm","chatFooterFormInput","minHeight","border","outline","paddingLeft","Chat","currentUserId","classes","seed","setSeed","input","setInput","roomName","setRoomName","roomId","Math","floor","random","get","then","res","setMessages","data","messages","name","pusher","cluster","channel","subscribe","bind","unsubscribe","unbind_all","hundleSubmit","e","preventDefault","message","console","log","post","timestamp","Date","length","map","i","_id","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Avatar, IconButton } from \"@material-ui/core\";\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\nimport SearchOutlined from \"@material-ui/icons/SearchOutlined\";\r\nimport AttachFile from \"@material-ui/icons/AttachFile\";\r\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\r\nimport SendIcon from \"@material-ui/icons/Send\";\r\nimport MicIcon from \"@material-ui/icons/Mic\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport axios from \"./axios\"\r\nimport Pusher from \"pusher-js\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  chat: {\r\n    flex: \"0.65\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  chatHeader: {\r\n    padding: \"20px\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    borderBottom: \"1px solid lightgray\",\r\n  },\r\n  chatHeaderInfo: {\r\n    flex: \"1\",\r\n  },\r\n  chatHeaderRight: {\r\n    marginLeft: \"auto\",\r\n  },\r\n  chatBody: {\r\n    flex: \"1\",\r\n    backgroundImage:\r\n      \"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')\",\r\n    backgroundRepeat: \"repeat\",\r\n    backgroundPosition: \"center\",\r\n    padding: \"30px\",\r\n    overflow: \"auto\",\r\n  },\r\n  chatMessage: {\r\n    position: \"relative\",\r\n    fontSize: \"16px\",\r\n    padding: \"10px\",\r\n    borderRadius: \"10px\",\r\n    width: \"fit-content\",\r\n    display: \"flex\",\r\n    backgroundColor: \"#ffffff\",\r\n    marginBottom: \"4%\",\r\n    [theme.breakpoints.down(\"sm\")]: {\r\n      marginBottom: \"8%\",\r\n    },\r\n  },\r\n  reciver: {\r\n    marginLeft: \"auto\",\r\n    backgroundColor: \"#dcf8c6\",\r\n  },\r\n\r\n  chatName: {\r\n    position: \"absolute\",\r\n    top: \"-15px\",\r\n    fontSize: \"10px\",\r\n  },\r\n  chatTimeStamp: {\r\n    fontSize: \"xx-small\",\r\n    marginLeft: \"6px\",\r\n    alignSelf: \"flex-end\",\r\n  },\r\n\r\n  chatFooter: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    height: \"62px\",\r\n    borderTop: \"1px solid lightgray\",\r\n  },\r\n  chatFooterForm: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    flex: \"1\",\r\n  },\r\n  chatFooterFormInput: {\r\n    flex: \"1\",\r\n    minHeight: \"40px\",\r\n    borderRadius: \"20px\",\r\n    border: \"none\",\r\n    outline: \"none\",\r\n    paddingLeft: \"2%\",\r\n    fontSize: \"18px\",\r\n  },\r\n}));\r\nfunction Chat() {\r\n  const currentUserId = \"asaf\";\r\n  const classes = useStyles(currentUserId === \"asaf\");\r\n  const [seed, setSeed] = useState(0);\r\n  const [input, setInput] = useState(\"\");\r\n  const [roomName, setRoomName] = useState(\"\");\r\n  const { roomId } = useParams();\r\n  useEffect(() => {\r\n    setSeed(Math.floor(Math.random() * 5000));\r\n  }, []);\r\n  useEffect(() => {\r\n    axios.get(`/rooms/${roomId}`).then((res) =>{ setMessages(res.data?.messages) ;setRoomName(res.data?.name)} );\r\n  },[roomId])\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    var pusher = new Pusher(\"899744c36189f508077b\", {\r\n      cluster: \"ap2\",\r\n    });\r\n    const channel = pusher.subscribe(\"chats\");\r\n    channel.bind(\"inserted\", (data) => {\r\n      setMessages([...messages, data]);\r\n    });\r\n\r\n    return () => {\r\n      channel.unsubscribe();\r\n      channel.unbind_all();\r\n    };\r\n  }, [messages]);\r\n\r\n  let hundleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if(!roomName){\r\n      setMessages([{message:\"please select a room\"}])\r\n      console.log(\"no room\");\r\n      \r\n      return\r\n    }\r\n    axios.post(`/createmessage/${roomId}`,{\r\n      message: input,\r\n      name: currentUserId,\r\n      timestamp: new Date(),\r\n    });\r\n    setInput(\"\");\r\n  };\r\n  return (\r\n    <div className={classes.chat}>\r\n      <div className={classes.chatHeader}>\r\n        <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\r\n        <div className={classes.chatHeaderInfo}>\r\n          <h3>{roomName}</h3>\r\n          <p>last seen:{messages[messages.length-1]?.timestamp}</p>\r\n        </div>\r\n        <div className={classes.chatHeaderRight}>\r\n          <IconButton size=\"small\">\r\n            <SearchOutlined />\r\n          </IconButton>\r\n          <IconButton>\r\n            <AttachFile />\r\n          </IconButton>\r\n          <IconButton size=\"small\">\r\n            <MoreVertIcon />\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n      <div className={classes.chatBody}>\r\n        {messages?.map((message, i) => (\r\n          <p\r\n            key={message._id}\r\n            className={`${classes.chatMessage} ${\r\n              message.name === currentUserId && classes.reciver\r\n            }`}\r\n          >\r\n            <span className={`${classes.chatName}  `}> {message.name}</span>\r\n            {message.message}\r\n            <span className={classes.chatTimeStamp}>\r\n              {message?.timestamp}\r\n            </span>\r\n          </p>\r\n        ))}\r\n      </div>\r\n\r\n      <div className={classes.chatFooter}>\r\n        <IconButton>\r\n          <InsertEmoticonIcon />\r\n        </IconButton>\r\n\r\n        <form onSubmit={hundleSubmit} className={classes.chatFooterForm}>\r\n          <input\r\n            type=\"text\"\r\n            className={classes.chatFooterFormInput}\r\n            placeholder=\"Type a message\"\r\n            value={input}\r\n            onChange={(e) => setInput(e.target.value)}\r\n          />\r\n          <IconButton type=\"submit\">\r\n            <SendIcon />\r\n          </IconButton>\r\n          <IconButton>\r\n            <MicIcon />\r\n          </IconButton>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n"]},"metadata":{},"sourceType":"module"}